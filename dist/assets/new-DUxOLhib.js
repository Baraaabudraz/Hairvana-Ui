import{j as e,a0 as z,U as v,X as J,aa as O,ac as B,ab as X,B as Z,i as K}from"./ui-vendor-B2pFoMNi.js";import{u as Q,a as x,L as E}from"./react-vendor-C7H4r9IR.js";import{u as W,b as Y,e as k,s as c,f as ee,g as se,l as g}from"./data-vendor-CIeUuS6O.js";import{h as ae,B as w,C as j,b as f,c as b,e as N,d as y,L as t,I as i,t as re}from"./index-DyoA978M.js";import{c as te}from"./users-Bg4EtP47.js";import"./db-vendor-BXl3LOEh.js";import"./charts-vendor-BwF8VYvl.js";const S=Y({name:c().min(2,"Name must be at least 2 characters"),email:c().email("Invalid email address"),phone:c().min(10,"Phone number must be at least 10 characters"),password:c().min(8,"Password must be at least 8 characters"),confirmPassword:c(),role:k(["admin","super_admin","salon","user"])}),T=S.extend({permissions:ee(c()).min(1,"At least one permission is required")}),ne=S.extend({salonName:c().min(2,"Salon name is required"),salonAddress:c().min(10,"Salon address is required"),businessLicense:c().min(5,"Business license is required"),subscription:k(["Basic","Standard","Premium"])}),le=se("role",[T.extend({role:g("admin")}),T.extend({role:g("super_admin")}),ne.extend({role:g("salon")}),S.extend({role:g("user")})]).refine(p=>p.password===p.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),ie=["manage_salons","manage_users","view_analytics","manage_subscriptions","manage_payments","manage_reports","manage_notifications","manage_settings","full_access"],ce={manage_salons:"Create, edit, and manage salon accounts",manage_users:"Manage user accounts and permissions",view_analytics:"Access platform analytics and reports",manage_subscriptions:"Handle subscription plans and billing",manage_payments:"Process and manage payments",manage_reports:"Generate and view system reports",manage_notifications:"Send and manage notifications",manage_settings:"Configure platform settings",full_access:"Complete administrative access"};function ge(){const p=Q(),{toast:_}=ae(),[P,C]=x.useState(!1),[n,I]=x.useState("user"),[A,h]=x.useState([]),[u,U]=x.useState(""),{register:o,handleSubmit:R,formState:{errors:r},watch:F,setValue:L}=W({resolver:re(le),defaultValues:{role:"user"}});F("role");const q=s=>{I(s),L("role",s),h([]),s==="super_admin"&&h(["full_access"])},D=s=>{h(s==="full_access"?["full_access"]:l=>{const m=l.filter(d=>d!=="full_access");return l.includes(s)?m.filter(d=>d!==s):[...m,s]})},M=s=>{s.target.files?.[0]&&U("https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=100&h=100&dpr=2")},$=async s=>{C(!0);try{const l={...s,avatar:u||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=100&h=100&dpr=2",...s.role==="admin"||s.role==="super_admin"?{permissions:A}:{}},{confirmPassword:m,...d}=l;await te(d),_({title:"User created successfully",description:`${s.name} has been added to the platform.`}),p("/dashboard/users")}catch{_({title:"Error creating user",description:"Please try again later.",variant:"destructive"})}finally{C(!1)}},G=s=>{switch(s){case"super_admin":return B;case"admin":return K;case"salon":return Z;case"user":return v;default:return v}},H=s=>{switch(s){case"super_admin":return"from-purple-600 to-purple-700";case"admin":return"from-blue-600 to-blue-700";case"salon":return"from-green-600 to-green-700";case"user":return"from-gray-600 to-gray-700";default:return"from-gray-600 to-gray-700"}},a=r;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{to:"/dashboard/users",children:e.jsx(w,{variant:"ghost",size:"icon",children:e.jsx(z,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New User"}),e.jsx("p",{className:"text-gray-600",children:"Create a new user account for the platform"})]})]}),e.jsxs("form",{onSubmit:R($),className:"space-y-6",children:[e.jsxs(j,{className:"border-0 shadow-sm",children:[e.jsxs(f,{children:[e.jsx(b,{children:"User Role"}),e.jsx(N,{children:"Select the type of user account to create"})]}),e.jsx(y,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{role:"user",title:"Customer",description:"Regular platform user who books services"},{role:"salon",title:"Salon Owner",description:"Manages salon and provides services"},{role:"admin",title:"Admin",description:"Platform administrator with limited access"},{role:"super_admin",title:"Super Admin",description:"Full platform access and control"}].map(({role:s,title:l,description:m})=>{const d=G(s),V=n===s;return e.jsxs("button",{type:"button",onClick:()=>q(s),className:`p-4 rounded-lg border-2 text-left transition-all ${V?"border-purple-200 bg-purple-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-r ${H(s)}`,children:e.jsx(d,{className:"h-4 w-4 text-white"})}),e.jsx("h3",{className:"font-semibold text-gray-900",children:l})]}),e.jsx("p",{className:"text-sm text-gray-600",children:m})]},s)})})})]}),e.jsxs(j,{className:"border-0 shadow-sm",children:[e.jsxs(f,{children:[e.jsx(b,{children:"Basic Information"}),e.jsx(N,{children:"Enter the user's personal details"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:u?e.jsx("img",{src:u,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx(v,{className:"h-8 w-8 text-gray-400"})}),u&&e.jsx("button",{type:"button",onClick:()=>U(""),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:e.jsx(J,{className:"h-3 w-3"})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"avatar",className:"cursor-pointer",children:e.jsxs("div",{className:"flex items-center gap-2 text-purple-600 hover:text-purple-700",children:[e.jsx(O,{className:"h-4 w-4"}),"Upload Avatar"]})}),e.jsx(i,{id:"avatar",type:"file",accept:"image/*",onChange:M,className:"hidden"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG up to 2MB"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"name",children:"Full Name *"}),e.jsx(i,{id:"name",placeholder:"Enter full name",...o("name")}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"email",children:"Email Address *"}),e.jsx(i,{id:"email",type:"email",placeholder:"user@example.com",...o("email")}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email.message})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(i,{id:"phone",placeholder:"+1 (555) 123-4567",...o("phone")}),r.phone&&e.jsx("p",{className:"text-sm text-red-500",children:r.phone.message})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"password",children:"Password *"}),e.jsx(i,{id:"password",type:"password",placeholder:"Enter password",...o("password")}),r.password&&e.jsx("p",{className:"text-sm text-red-500",children:r.password.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"confirmPassword",children:"Confirm Password *"}),e.jsx(i,{id:"confirmPassword",type:"password",placeholder:"Confirm password",...o("confirmPassword")}),r.confirmPassword&&e.jsx("p",{className:"text-sm text-red-500",children:r.confirmPassword.message})]})]})]})]}),(n==="admin"||n==="super_admin")&&e.jsxs(j,{className:"border-0 shadow-sm",children:[e.jsxs(f,{children:[e.jsx(b,{children:"Admin Permissions"}),e.jsx(N,{children:n==="super_admin"?"Super admins have full access to all platform features":"Select the permissions for this admin user"})]}),e.jsx(y,{children:n==="super_admin"?e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{className:"font-semibold text-purple-900",children:"Full Administrative Access"})]}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"This user will have complete control over all platform features and settings."})]}):e.jsx("div",{className:"space-y-3",children:ie.filter(s=>s!=="full_access").map(s=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{type:"checkbox",id:s,checked:A.includes(s),onChange:()=>D(s),className:"mt-1 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(t,{htmlFor:s,className:"font-medium cursor-pointer",children:s.replace(/_/g," ").replace(/\b\w/g,l=>l.toUpperCase())}),e.jsx("p",{className:"text-sm text-gray-600",children:ce[s]})]})]},s))})})]}),n==="salon"&&e.jsxs(j,{className:"border-0 shadow-sm",children:[e.jsxs(f,{children:[e.jsx(b,{children:"Salon Information"}),e.jsx(N,{children:"Enter details about the salon this user will manage"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"salonName",children:"Salon Name *"}),e.jsx(i,{id:"salonName",placeholder:"Enter salon name",...o("salonName")}),n==="salon"&&a.salonName&&e.jsx("p",{className:"text-sm text-red-500",children:typeof a.salonName.message=="string"?a.salonName.message:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"businessLicense",children:"Business License *"}),e.jsx(i,{id:"businessLicense",placeholder:"BL123456789",...o("businessLicense")}),n==="salon"&&a.businessLicense&&e.jsx("p",{className:"text-sm text-red-500",children:typeof a.businessLicense.message=="string"?a.businessLicense.message:""})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"salonAddress",children:"Salon Address *"}),e.jsx(i,{id:"salonAddress",placeholder:"123 Main Street, City, State, ZIP",...o("salonAddress")}),n==="salon"&&a.salonAddress&&e.jsx("p",{className:"text-sm text-red-500",children:typeof a.salonAddress.message=="string"?a.salonAddress.message:""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Subscription Plan *"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:["Basic","Standard","Premium"].map(s=>e.jsx("button",{type:"button",onClick:()=>L("subscription",s),className:`p-3 rounded-lg border text-sm font-medium transition-colors ${F("subscription")===s?"bg-purple-50 border-purple-200 text-purple-700":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:s},s))}),n==="salon"&&a.subscription&&e.jsx("p",{className:"text-sm text-red-500",children:typeof a.subscription.message=="string"?a.subscription.message:""})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(E,{to:"/dashboard/users",children:e.jsx(w,{variant:"outline",type:"button",children:"Cancel"})}),e.jsxs(w,{type:"submit",disabled:P,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),P?"Creating...":"Create User"]})]})]})]})}export{ge as default};
