import{j as e,a0 as Q,Q as X,X as D,aa as ee}from"./ui-vendor-B2pFoMNi.js";import{u as se,a as o,L as A}from"./react-vendor-C7H4r9IR.js";import{u as ae,b as re,s as c,l as le}from"./data-vendor-CIeUuS6O.js";import{h as te,B as S,C as h,b as x,c as p,e as u,d as j,L as l,I as i,t as ie}from"./index-DHCScZ-8.js";import{B as ne}from"./badge-C_Aht46l.js";import{S as ce,a as de,b as oe,c as me,d as F}from"./select-CUY2LhsK.js";import{c as he}from"./salons-DHNjjMH_.js";import{f as xe}from"./users-C87p8_fO.js";import"./db-vendor-BXl3LOEh.js";import"./charts-vendor-BwF8VYvl.js";const pe=re({name:c().min(2,"Salon name must be at least 2 characters"),email:c().email("Invalid email address"),phone:c().min(10,"Phone number must be at least 10 characters"),address:c().min(10,"Address must be at least 10 characters"),city:c().min(2,"City is required"),state:c().min(2,"State is required"),zipCode:c().min(5,"ZIP code must be at least 5 characters"),website:c().url("Invalid website URL").optional().or(le("")),description:c().min(20,"Description must be at least 20 characters"),owner_id:c().min(1,"Please select an owner"),businessLicense:c().min(5,"Business license number is required"),taxId:c().min(9,"Tax ID is required")}),ue=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],je=["Haircut","Hair Color","Hair Styling","Hair Treatment","Beard Trim","Eyebrow Threading","Facial","Manicure","Pedicure","Massage"];function Le(){const U=se(),{toast:y}=te(),[O,P]=o.useState(!1),[g,C]=o.useState([]),[v,$]=o.useState(""),[N,M]=o.useState(""),[w,q]=o.useState([]),[R,E]=o.useState(!0),[b,T]=o.useState({monday:{open:"09:00",close:"18:00",closed:!1},tuesday:{open:"09:00",close:"18:00",closed:!1},wednesday:{open:"09:00",close:"18:00",closed:!1},thursday:{open:"09:00",close:"18:00",closed:!1},friday:{open:"09:00",close:"19:00",closed:!1},saturday:{open:"08:00",close:"19:00",closed:!1},sunday:{open:"10:00",close:"18:00",closed:!1}}),[I,k]=o.useState([]),{register:d,handleSubmit:G,setValue:_,formState:{errors:r}}=ae({resolver:ie(pe)});o.useEffect(()=>{(async()=>{try{E(!0);const a=await xe({role:"salon"});q(a.users||[])}catch(a){console.error("Error loading owners:",a),y({title:"Error",description:"Failed to load salon owners. Please try again.",variant:"destructive"})}finally{E(!1)}})()},[y]),o.useEffect(()=>{_("owner_id",N)},[N,_]);const V=s=>{C(a=>a.includes(s)?a.filter(t=>t!==s):[...a,s])},B=()=>{v.trim()&&!g.includes(v.trim())&&(C(s=>[...s,v.trim()]),$(""))},W=s=>{C(a=>a.filter(t=>t!==s))},H=(s,a,t)=>{T(n=>({...n,[s]:{...n[s],[a]:t}}))},Y=s=>{T(a=>({...a,[s]:{...a[s],closed:!a[s].closed}}))},Z=s=>{const a=s.target.files;if(a){const t=Array.from(a).map((n,m)=>`https://images.pexels.com/photos/399999${m}/pexels-photo-399999${m}.jpeg?auto=compress&cs=tinysrgb&w=400&h=300&dpr=2`);k(n=>[...n,...t].slice(0,5))}},J=s=>{k(a=>a.filter((t,n)=>n!==s))},z=s=>{const[a,t]=s.split(":"),n=parseInt(a,10),m=n>=12?"PM":"AM";return`${n%12||12}:${t} ${m}`},K=async s=>{P(!0);try{const a=w.find(f=>f.id===s.owner_id);if(!a)throw new Error("Selected owner not found");const t={};Object.entries(b).forEach(([f,L])=>{L.closed?t[f]="Closed":t[f]=`${z(L.open)} - ${z(L.close)}`});const n=`${s.address}, ${s.city}, ${s.state} ${s.zipCode}`,m={name:s.name,email:s.email,phone:s.phone,address:n,location:`${s.city}, ${s.state}`,website:s.website||null,description:s.description,owner_id:s.owner_id,owner_name:a.name,owner_email:a.email,business_license:s.businessLicense,tax_id:s.taxId,services:g,hours:t,images:I,status:"pending"};await he(m),y({title:"Salon created successfully",description:"The salon has been submitted for review and approval."}),U("/dashboard/salons")}catch{y({title:"Error creating salon",description:"Please try again later.",variant:"destructive"})}finally{P(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(A,{to:"/dashboard/salons",children:e.jsx(S,{variant:"ghost",size:"icon",children:e.jsx(Q,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Add New Salon"}),e.jsx("p",{className:"text-gray-600",children:"Register a new salon on the platform"})]})]}),e.jsxs("form",{onSubmit:G(K),className:"space-y-6",children:[e.jsxs(h,{className:"border-0 shadow-sm",children:[e.jsxs(x,{children:[e.jsx(p,{children:"Basic Information"}),e.jsx(u,{children:"Enter the basic details about the salon"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Salon Name *"}),e.jsx(i,{id:"name",placeholder:"Enter salon name",...d("name")}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email *"}),e.jsx(i,{id:"email",type:"email",placeholder:"salon@example.com",...d("email")}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Phone *"}),e.jsx(i,{id:"phone",placeholder:"+1 (555) 123-4567",...d("phone")}),r.phone&&e.jsx("p",{className:"text-sm text-red-500",children:r.phone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"website",children:"Website"}),e.jsx(i,{id:"website",placeholder:"https://www.salon.com",...d("website")}),r.website&&e.jsx("p",{className:"text-sm text-red-500",children:r.website.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"description",children:"Description *"}),e.jsx("textarea",{id:"description",rows:4,className:"flex w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",placeholder:"Describe your salon, services, and what makes it special...",...d("description")}),r.description&&e.jsx("p",{className:"text-sm text-red-500",children:r.description.message})]})]})]}),e.jsxs(h,{className:"border-0 shadow-sm",children:[e.jsxs(x,{children:[e.jsx(p,{children:"Location Information"}),e.jsx(u,{children:"Provide the salon's physical address"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"address",children:"Street Address *"}),e.jsx(i,{id:"address",placeholder:"123 Main Street",...d("address")}),r.address&&e.jsx("p",{className:"text-sm text-red-500",children:r.address.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"city",children:"City *"}),e.jsx(i,{id:"city",placeholder:"New York",...d("city")}),r.city&&e.jsx("p",{className:"text-sm text-red-500",children:r.city.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"state",children:"State *"}),e.jsx(i,{id:"state",placeholder:"NY",...d("state")}),r.state&&e.jsx("p",{className:"text-sm text-red-500",children:r.state.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"zipCode",children:"ZIP Code *"}),e.jsx(i,{id:"zipCode",placeholder:"10001",...d("zipCode")}),r.zipCode&&e.jsx("p",{className:"text-sm text-red-500",children:r.zipCode.message})]})]})]})]}),e.jsxs(h,{className:"border-0 shadow-sm",children:[e.jsxs(x,{children:[e.jsx(p,{children:"Owner Information"}),e.jsx(u,{children:"Details about the salon owner or manager"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"owner_id",children:"Owner *"}),e.jsxs(ce,{value:N,onValueChange:M,children:[e.jsx(de,{children:e.jsx(oe,{placeholder:"Select an owner"})}),e.jsx(me,{children:R?e.jsx(F,{value:"loading",disabled:!0,children:"Loading owners..."}):w.length===0?e.jsx(F,{value:"no-owners",disabled:!0,children:"No owners available"}):w.map(s=>e.jsxs(F,{value:s.id,children:[s.name," (",s.email,")"]},s.id))})]}),r.owner_id&&e.jsx("p",{className:"text-sm text-red-500",children:r.owner_id.message})]}),N&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Selected Owner Details"}),(()=>{const s=w.find(a=>a.id===N);return s?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",s.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",s.email]}),s.phone&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",s.phone]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Role:"})," ",s.role]}),s.status&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Status:"}),e.jsx("span",{className:`ml-1 px-2 py-1 rounded-full text-xs ${s.status==="active"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status})]})]}):null})()]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"businessLicense",children:"Business License *"}),e.jsx(i,{id:"businessLicense",placeholder:"BL123456789",...d("businessLicense")}),r.businessLicense&&e.jsx("p",{className:"text-sm text-red-500",children:r.businessLicense.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"taxId",children:"Tax ID *"}),e.jsx(i,{id:"taxId",placeholder:"12-3456789",...d("taxId")}),r.taxId&&e.jsx("p",{className:"text-sm text-red-500",children:r.taxId.message})]})]})]}),e.jsxs(h,{className:"border-0 shadow-sm",children:[e.jsxs(x,{children:[e.jsx(p,{children:"Services Offered"}),e.jsx(u,{children:"Select the services your salon provides"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:je.map(s=>e.jsx("button",{type:"button",onClick:()=>V(s),className:`p-3 rounded-lg border text-sm font-medium transition-colors ${g.includes(s)?"bg-purple-50 border-purple-200 text-purple-700":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:s},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{placeholder:"Add custom service",value:v,onChange:s=>$(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),B())}),e.jsx(S,{type:"button",onClick:B,variant:"outline",children:e.jsx(X,{className:"h-4 w-4"})})]}),g.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Selected Services:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(s=>e.jsxs(ne,{variant:"secondary",className:"flex items-center gap-1",children:[s,e.jsx("button",{type:"button",onClick:()=>W(s),className:"ml-1 hover:text-red-500",children:e.jsx(D,{className:"h-3 w-3"})})]},s))})]})]})]}),e.jsxs(h,{className:"border-0 shadow-sm",children:[e.jsxs(x,{children:[e.jsx(p,{children:"Operating Hours"}),e.jsx(u,{children:"Set the salon's operating hours for each day"})]}),e.jsx(j,{className:"space-y-4",children:ue.map(s=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24",children:e.jsx(l,{className:"capitalize",children:s})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:b[s].closed,onChange:()=>Y(s),className:"rounded"}),e.jsx(l,{className:"text-sm",children:"Closed"})]}),!b[s].closed&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{type:"time",value:b[s].open,onChange:a=>H(s,"open",a.target.value),className:"w-32"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx(i,{type:"time",value:b[s].close,onChange:a=>H(s,"close",a.target.value),className:"w-32"})]})]},s))})]}),e.jsxs(h,{className:"border-0 shadow-sm",children:[e.jsxs(x,{children:[e.jsx(p,{children:"Salon Images"}),e.jsx(u,{children:"Upload photos of your salon (maximum 5 images)"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(ee,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"mt-4",children:[e.jsxs(l,{htmlFor:"images",className:"cursor-pointer",children:[e.jsx("span",{className:"text-purple-600 hover:text-purple-500",children:"Upload images"}),e.jsx("span",{className:"text-gray-500",children:" or drag and drop"})]}),e.jsx(i,{id:"images",type:"file",multiple:!0,accept:"image/*",onChange:Z,className:"hidden"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"PNG, JPG, GIF up to 10MB each"})]}),I.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:I.map((s,a)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s,alt:`Salon image ${a+1}`,className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>J(a),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:e.jsx(D,{className:"h-3 w-3"})})]},a))})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(A,{to:"/dashboard/salons",children:e.jsx(S,{variant:"outline",type:"button",children:"Cancel"})}),e.jsx(S,{type:"submit",disabled:O,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:O?"Creating...":"Create Salon"})]})]})]})}export{Le as default};
