import{j as e,a0 as ae,Q as re,X as D,aa as te,ab as ie}from"./ui-vendor-B2pFoMNi.js";import{k as le,u as ne,a as p,L as M}from"./react-vendor-C7H4r9IR.js";import{u as ce,b as de,s as d,l as oe}from"./data-vendor-CIeUuS6O.js";import{h as me,B as C,C as x,b as u,c as j,e as g,d as N,L as l,I as n,t as he}from"./index-DyoA978M.js";import{B as pe}from"./badge-DN3GUanR.js";import{a as xe,b as ue}from"./salons-B0SwCEqs.js";import"./db-vendor-BXl3LOEh.js";import"./charts-vendor-BwF8VYvl.js";const je=de({name:d().min(2,"Salon name must be at least 2 characters"),email:d().email("Invalid email address"),phone:d().min(10,"Phone number must be at least 10 characters"),address:d().min(10,"Address must be at least 10 characters"),city:d().min(2,"City is required"),state:d().min(2,"State is required"),zipCode:d().min(5,"ZIP code must be at least 5 characters"),website:d().url("Invalid website URL").optional().or(oe("")),description:d().min(20,"Description must be at least 20 characters"),ownerName:d().min(2,"Owner name is required"),ownerEmail:d().email("Invalid owner email"),ownerPhone:d().min(10,"Owner phone is required"),businessLicense:d().min(5,"Business license number is required"),taxId:d().min(9,"Tax ID is required")}),ge=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],Ne=["Haircut","Hair Color","Hair Styling","Hair Treatment","Beard Trim","Eyebrow Threading","Facial","Manicure","Pedicure","Massage"];function Pe(){const m=le(),q=ne(),{toast:v}=me(),[F,$]=p.useState(!1),[_,L]=p.useState(!0),[b,w]=p.useState([]),[S,k]=p.useState(""),[f,I]=p.useState({}),[P,E]=p.useState([]),{register:c,handleSubmit:G,formState:{errors:r},reset:T}=ce({resolver:he(je)});p.useEffect(()=>{const s=async()=>{try{L(!0);const a=await xe(m.id),i=a.address.split(", "),t=i[0],o=i[1],h=i[2]?.split(" "),R=h?.[0],X=h?.[1];T({name:a.name,email:a.email,phone:a.phone,address:t,city:o||"",state:R||"",zipCode:X||"",website:a.website||"",description:a.description||"",ownerName:a.owner_name||"",ownerEmail:a.owner_email||"",ownerPhone:a.owner_phone||"",businessLicense:a.business_license||"",taxId:a.tax_id||""});const O={};Object.entries(a.hours).forEach(([y,A])=>{if(typeof A=="string"){const[ee,se]=A.split(" - ");O[y]={open:H(ee),close:H(se),closed:!1}}});const V=Array.isArray(a.services)?a.services.map(y=>typeof y=="string"?y:y.name):[];w(V),I(O),E(a.images||[])}catch(a){console.error("Error fetching salon:",a),v({title:"Error loading salon",description:"Could not load salon data. Please try again.",variant:"destructive"})}finally{L(!1)}};m.id&&s()},[m.id,T,v]);const H=s=>{const[a,i]=s.split(" ");let[t,o]=a.split(":");return t==="12"&&(t="00"),i==="PM"&&(t=String(parseInt(t,10)+12)),`${t.padStart(2,"0")}:${o}`},U=s=>{const[a,i]=s.split(":"),t=parseInt(a,10),o=t>=12?"PM":"AM";return`${t%12||12}:${i} ${o}`},Z=s=>{w(a=>a.includes(s)?a.filter(i=>i!==s):[...a,s])},z=()=>{S.trim()&&!b.includes(S.trim())&&(w(s=>[...s,S.trim()]),k(""))},J=s=>{w(a=>a.filter(i=>i!==s))},B=(s,a,i)=>{I(t=>({...t,[s]:{...t[s],[a]:i}}))},W=s=>{I(a=>({...a,[s]:{...a[s],closed:!a[s].closed}}))},Y=s=>{const a=s.target.files;if(a){const i=Array.from(a).map((t,o)=>`https://images.pexels.com/photos/399999${o}/pexels-photo-399999${o}.jpeg?auto=compress&cs=tinysrgb&w=400&h=300&dpr=2`);E(t=>[...t,...i].slice(0,5))}},K=s=>{E(a=>a.filter((i,t)=>t!==s))},Q=async s=>{$(!0);try{const a={};Object.entries(f).forEach(([o,h])=>{h.closed?a[o]="Closed":a[o]=`${U(h.open)} - ${U(h.close)}`});const i=`${s.address}, ${s.city}, ${s.state} ${s.zipCode}`,t={...s,address:i,services:b,hours:a,images:P};await ue(m.id,t),v({title:"Salon updated successfully",description:"The salon information has been updated."}),q(`/dashboard/salons/${m.id}`)}catch{v({title:"Error updating salon",description:"Please try again later.",variant:"destructive"})}finally{$(!1)}};return _?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(M,{to:`/dashboard/salons/${m.id}`,children:e.jsx(C,{variant:"ghost",size:"icon",children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Salon"}),e.jsx("p",{className:"text-gray-600",children:"Update salon information and settings"})]})]}),e.jsxs("form",{onSubmit:G(Q),className:"space-y-6",children:[e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsxs(u,{children:[e.jsx(j,{children:"Basic Information"}),e.jsx(g,{children:"Update the basic details about the salon"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Salon Name *"}),e.jsx(n,{id:"name",placeholder:"Enter salon name",...c("name")}),r.name&&e.jsx("p",{className:"text-sm text-red-500",children:r.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email *"}),e.jsx(n,{id:"email",type:"email",placeholder:"salon@example.com",...c("email")}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"phone",children:"Phone *"}),e.jsx(n,{id:"phone",placeholder:"+1 (555) 123-4567",...c("phone")}),r.phone&&e.jsx("p",{className:"text-sm text-red-500",children:r.phone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"website",children:"Website"}),e.jsx(n,{id:"website",placeholder:"https://www.salon.com",...c("website")}),r.website&&e.jsx("p",{className:"text-sm text-red-500",children:r.website.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"description",children:"Description *"}),e.jsx("textarea",{id:"description",rows:4,className:"flex w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",placeholder:"Describe your salon, services, and what makes it special...",...c("description")}),r.description&&e.jsx("p",{className:"text-sm text-red-500",children:r.description.message})]})]})]}),e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsxs(u,{children:[e.jsx(j,{children:"Location Information"}),e.jsx(g,{children:"Update the salon's physical address"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"address",children:"Street Address *"}),e.jsx(n,{id:"address",placeholder:"123 Main Street",...c("address")}),r.address&&e.jsx("p",{className:"text-sm text-red-500",children:r.address.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"city",children:"City *"}),e.jsx(n,{id:"city",placeholder:"New York",...c("city")}),r.city&&e.jsx("p",{className:"text-sm text-red-500",children:r.city.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"state",children:"State *"}),e.jsx(n,{id:"state",placeholder:"NY",...c("state")}),r.state&&e.jsx("p",{className:"text-sm text-red-500",children:r.state.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"zipCode",children:"ZIP Code *"}),e.jsx(n,{id:"zipCode",placeholder:"10001",...c("zipCode")}),r.zipCode&&e.jsx("p",{className:"text-sm text-red-500",children:r.zipCode.message})]})]})]})]}),e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsxs(u,{children:[e.jsx(j,{children:"Owner Information"}),e.jsx(g,{children:"Update details about the salon owner or manager"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ownerName",children:"Owner Name *"}),e.jsx(n,{id:"ownerName",placeholder:"John Doe",...c("ownerName")}),r.ownerName&&e.jsx("p",{className:"text-sm text-red-500",children:r.ownerName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ownerEmail",children:"Owner Email *"}),e.jsx(n,{id:"ownerEmail",type:"email",placeholder:"owner@example.com",...c("ownerEmail")}),r.ownerEmail&&e.jsx("p",{className:"text-sm text-red-500",children:r.ownerEmail.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ownerPhone",children:"Owner Phone *"}),e.jsx(n,{id:"ownerPhone",placeholder:"+1 (555) 123-4567",...c("ownerPhone")}),r.ownerPhone&&e.jsx("p",{className:"text-sm text-red-500",children:r.ownerPhone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"businessLicense",children:"Business License *"}),e.jsx(n,{id:"businessLicense",placeholder:"BL123456789",...c("businessLicense")}),r.businessLicense&&e.jsx("p",{className:"text-sm text-red-500",children:r.businessLicense.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"taxId",children:"Tax ID *"}),e.jsx(n,{id:"taxId",placeholder:"12-3456789",...c("taxId")}),r.taxId&&e.jsx("p",{className:"text-sm text-red-500",children:r.taxId.message})]})]})]}),e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsxs(u,{children:[e.jsx(j,{children:"Services Offered"}),e.jsx(g,{children:"Update the services your salon provides"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:Ne.map(s=>e.jsx("button",{type:"button",onClick:()=>Z(s),className:`p-3 rounded-lg border text-sm font-medium transition-colors ${b.includes(s)?"bg-purple-50 border-purple-200 text-purple-700":"bg-white border-gray-200 text-gray-700 hover:bg-gray-50"}`,children:s},s))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{placeholder:"Add custom service",value:S,onChange:s=>k(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),z())}),e.jsx(C,{type:"button",onClick:z,variant:"outline",children:e.jsx(re,{className:"h-4 w-4"})})]}),b.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Selected Services:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(s=>e.jsxs(pe,{variant:"secondary",className:"flex items-center gap-1",children:[s,e.jsx("button",{type:"button",onClick:()=>J(s),className:"ml-1 hover:text-red-500",children:e.jsx(D,{className:"h-3 w-3"})})]},s))})]})]})]}),e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsxs(u,{children:[e.jsx(j,{children:"Operating Hours"}),e.jsx(g,{children:"Update the salon's operating hours for each day"})]}),e.jsx(N,{className:"space-y-4",children:ge.map(s=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24",children:e.jsx(l,{className:"capitalize",children:s})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:f[s]?.closed||!1,onChange:()=>W(s),className:"rounded"}),e.jsx(l,{className:"text-sm",children:"Closed"})]}),!f[s]?.closed&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{type:"time",value:f[s]?.open||"09:00",onChange:a=>B(s,"open",a.target.value),className:"w-32"}),e.jsx("span",{className:"text-gray-500",children:"to"}),e.jsx(n,{type:"time",value:f[s]?.close||"18:00",onChange:a=>B(s,"close",a.target.value),className:"w-32"})]})]},s))})]}),e.jsxs(x,{className:"border-0 shadow-sm",children:[e.jsxs(u,{children:[e.jsx(j,{children:"Salon Images"}),e.jsx(g,{children:"Update photos of your salon (maximum 5 images)"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(te,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"mt-4",children:[e.jsxs(l,{htmlFor:"images",className:"cursor-pointer",children:[e.jsx("span",{className:"text-purple-600 hover:text-purple-500",children:"Upload new images"}),e.jsx("span",{className:"text-gray-500",children:" or drag and drop"})]}),e.jsx(n,{id:"images",type:"file",multiple:!0,accept:"image/*",onChange:Y,className:"hidden"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"PNG, JPG, GIF up to 10MB each"})]}),P.length>0&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:P.map((s,a)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s,alt:`Salon image ${a+1}`,className:"w-full h-24 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>K(a),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:e.jsx(D,{className:"h-3 w-3"})})]},a))})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(M,{to:`/dashboard/salons/${m.id}`,children:e.jsx(C,{variant:"outline",type:"button",children:"Cancel"})}),e.jsxs(C,{type:"submit",disabled:F,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),F?"Saving...":"Save Changes"]})]})]})]})}export{Pe as default};
