import{j as e,a0 as W,z as w,aa as X,a6 as Y,a5 as ee,B as U,ab as se,U as ae,i as te,ac as re}from"./ui-vendor-B2pFoMNi.js";import{k as le,u as ne,a as i,L as g}from"./react-vendor-C7H4r9IR.js";import{u as ie,b as oe,e as C,s as j}from"./data-vendor-CIeUuS6O.js";import{h as ce,B as o,C as A,b as E,c as T,e as L,d as k,A as B,f as D,g as F,I as h,L as c,t as de}from"./index-DHCScZ-8.js";import{B as P}from"./badge-C_Aht46l.js";import{S as I,a as R,b as _,c as H,d as n}from"./select-CUY2LhsK.js";import{a as me,b as he}from"./users-C87p8_fO.js";import"./db-vendor-BXl3LOEh.js";import"./charts-vendor-BwF8VYvl.js";const pe=oe({name:j().min(2,"Name must be at least 2 characters"),email:j().email("Invalid email address"),phone:j().min(10,"Phone number must be at least 10 characters"),role:C(["admin","super_admin","salon","user"]),status:C(["active","pending","suspended"])}),ue={super_admin:"bg-purple-100 text-purple-800",admin:"bg-blue-100 text-blue-800",salon:"bg-green-100 text-green-800",user:"bg-gray-100 text-gray-800"},xe={active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",suspended:"bg-red-100 text-red-800"};function Ue(){const d=le(),Z=ne(),{toast:m}=ce(),[s,v]=i.useState(null),[V,f]=i.useState(!0),[N,y]=i.useState(!1),[z,J]=i.useState(""),{register:p,handleSubmit:M,formState:{errors:r},reset:u,setValue:b,watch:S}=ie({resolver:de(pe)}),$=S("role");i.useEffect(()=>{const a=async()=>{try{f(!0);try{const t=await me(d.id);v(t),u({name:t.name,email:t.email,phone:t.phone,role:t.role,status:t.status})}catch(t){console.warn("API fetch failed, using mock data:",t);const l={1:{id:"1",name:"John Smith",email:"admin@hairvana.com",phone:"+1 (555) 123-4567",role:"admin",status:"active",joinDate:"2024-01-01",lastLogin:"2024-06-15T10:30:00Z",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2",permissions:["manage_salons","manage_users","view_analytics","manage_subscriptions"]},2:{id:"2",name:"Sarah Johnson",email:"superadmin@hairvana.com",phone:"+1 (555) 234-5678",role:"super_admin",status:"active",joinDate:"2024-01-01",lastLogin:"2024-06-15T09:15:00Z",avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2",permissions:["full_access"]},3:{id:"3",name:"Maria Rodriguez",email:"maria@luxehair.com",phone:"+1 (555) 345-6789",role:"salon",status:"active",joinDate:"2024-01-15",lastLogin:"2024-06-15T14:20:00Z",avatar:"https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2",salons:[],totalSalons:2,totalRevenue:20250,totalBookings:245},4:{id:"4",name:"David Chen",email:"david@stylecuts.com",phone:"+1 (555) 456-7890",role:"salon",status:"active",joinDate:"2024-01-20",lastLogin:"2024-06-15T11:45:00Z",avatar:"https://images.pexels.com/photos/2379004/pexels-photo-2379004.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2",salons:[],totalSalons:1,totalRevenue:8900,totalBookings:98},5:{id:"5",name:"Lisa Thompson",email:"lisa.thompson@email.com",phone:"+1 (555) 567-8901",role:"user",status:"active",joinDate:"2024-02-01",lastLogin:"2024-06-15T15:30:00Z",avatar:"https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2",totalBookings:8,totalSpent:650,favoriteServices:["Haircut","Hair Styling"]},6:{id:"6",name:"Emily Davis",email:"emily.davis@email.com",phone:"+1 (555) 678-9012",role:"user",status:"active",joinDate:"2024-02-01",lastLogin:"2024-06-15T13:20:00Z",avatar:"https://images.pexels.com/photos/1130626/pexels-photo-1130626.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=2",totalBookings:12,totalSpent:850,favoriteServices:["Haircut","Hair Color","Hair Styling"]}}[d.id];if(l)v(l),u({name:l.name,email:l.email,phone:l.phone,role:l.role,status:l.status});else throw new Error("User not found")}}catch(t){console.error("Error fetching user:",t),m({title:"Error",description:"Failed to load user details. Please try again.",variant:"destructive"})}finally{f(!1)}};d.id&&a()},[d.id,u,m]);const G=async a=>{if(s)try{y(!0),await he(s.id,a),m({title:"Success",description:"User updated successfully."}),Z(`/dashboard/users/${s.id}`)}catch(t){console.error("Error updating user:",t),m({title:"Validation Error",description:t.message||"Failed to update user. Please check the fields and try again.",variant:"destructive"})}finally{y(!1)}},O=a=>{const t=a.target.files?.[0];if(t){const x=new FileReader;x.onload=l=>{J(l.target?.result)},x.readAsDataURL(t)}},q=a=>{switch(a){case"super_admin":return"Super Admin";case"admin":return"Admin";case"salon":return"Salon Owner";case"user":return"Customer";default:return a}},K=()=>{switch(s?.role){case"super_admin":return re;case"admin":return te;case"salon":return U;case"user":return ae;default:return w}};if(V)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-600"})});if(!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"User not found"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"The user you're looking for doesn't exist."}),e.jsx(g,{to:"/dashboard/users",children:e.jsx(o,{className:"mt-4",children:"Back to Users"})})]})});const Q=K();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{to:`/dashboard/users/${s.id}`,children:e.jsx(o,{variant:"outline",size:"icon",children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit User"}),e.jsx("p",{className:"text-gray-600",children:"Update user information and settings"})]})]})}),e.jsxs("form",{onSubmit:M(G),className:"space-y-6",children:[e.jsxs(A,{className:"border-0 shadow-sm",children:[e.jsxs(E,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),"User Information"]}),e.jsx(L,{children:"Update the user's basic information and account status"})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs(B,{className:"h-24 w-24",children:[e.jsx(D,{src:z||s.avatar,alt:s.name}),e.jsx(F,{className:"text-lg",children:s.name.split(" ").map(a=>a[0]).join("")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{variant:"outline",type:"button",children:e.jsxs("label",{htmlFor:"avatar",className:"cursor-pointer flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Upload Photo"]})}),e.jsx(h,{id:"avatar",type:"file",accept:"image/*",onChange:O,className:"hidden"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG up to 2MB"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"name",children:"Full Name"}),e.jsx(h,{id:"name",...p("name"),placeholder:"Enter full name"}),r.name&&e.jsx("p",{className:"text-sm text-red-600",children:r.name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"email",children:"Email Address"}),e.jsx(h,{id:"email",type:"email",...p("email"),placeholder:"Enter email address"}),r.email&&e.jsx("p",{className:"text-sm text-red-600",children:r.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"phone",children:"Phone Number"}),e.jsx(h,{id:"phone",...p("phone"),placeholder:"Enter phone number"}),r.phone&&e.jsx("p",{className:"text-sm text-red-600",children:r.phone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"role",children:"Role"}),e.jsxs(I,{value:$,onValueChange:a=>b("role",a),children:[e.jsx(R,{children:e.jsx(_,{})}),e.jsxs(H,{children:[e.jsx(n,{value:"super_admin",children:"Super Admin"}),e.jsx(n,{value:"admin",children:"Admin"}),e.jsx(n,{value:"salon",children:"Salon Owner"}),e.jsx(n,{value:"user",children:"Customer"})]})]}),r.role&&e.jsx("p",{className:"text-sm text-red-600",children:r.role.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"status",children:"Status"}),e.jsxs(I,{value:S("status"),onValueChange:a=>b("status",a),children:[e.jsx(R,{children:e.jsx(_,{})}),e.jsxs(H,{children:[e.jsx(n,{value:"active",children:"Active"}),e.jsx(n,{value:"pending",children:"Pending"}),e.jsx(n,{value:"suspended",children:"Suspended"})]})]}),r.status&&e.jsx("p",{className:"text-sm text-red-600",children:r.status.message})]})]})]})]}),e.jsxs(A,{className:"border-0 shadow-sm",children:[e.jsxs(E,{children:[e.jsx(T,{children:"Current Information"}),e.jsx(L,{children:"This is the user's current information for reference"})]}),e.jsx(k,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(B,{className:"h-12 w-12",children:[e.jsx(D,{src:s.avatar,alt:s.name}),e.jsx(F,{children:s.name.split(" ").map(a=>a[0]).join("")})]}),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-white rounded-full p-1",children:e.jsx(Q,{className:"h-3 w-3 text-gray-600"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(P,{className:ue[s.role],children:q(s.role)}),e.jsx(P,{className:xe[s.status],children:s.status})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:s.email})]}),s.role==="salon"&&s.totalSalons&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{children:[s.totalSalons," salon(s)"]})]})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(g,{to:`/dashboard/users/${s.id}`,children:e.jsx(o,{variant:"outline",type:"button",children:"Cancel"})}),e.jsxs(o,{type:"submit",disabled:N,className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),N?"Saving...":"Save Changes"]})]})]})]})}export{Ue as default};
