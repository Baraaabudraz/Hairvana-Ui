import{j as e,a0 as j,ab as P}from"./ui-vendor-B2pFoMNi.js";import{u as w,k as F,a as l,L as h}from"./react-vendor-C7H4r9IR.js";import{h as S,B as p,C as E,b as I,c as L,e as U,d as M,L as i,I as r}from"./index-DHCScZ-8.js";import{h as A,i as B}from"./subscriptions-Dpt9SgIW.js";import"./db-vendor-BXl3LOEh.js";import"./data-vendor-CIeUuS6O.js";import"./charts-vendor-BwF8VYvl.js";const R=()=>{const y=w(),{id:n}=F(),{toast:c}=S(),[v,b]=l.useState(null),[s,o]=l.useState({name:"",description:"",price:"",yearly_price:"",billing_period:"monthly",features:"",limits:{max_users:"",max_bookings:"",max_staff:"",max_locations:""},status:"active"}),[u,f]=l.useState(!1),[_,N]=l.useState(!0),[d,x]=l.useState("");l.useEffect(()=>{(async()=>{if(n)try{const a=await A(n);b(a),o({name:a.name,description:a.description||"",price:a.price,yearly_price:a.yearly_price,billing_period:a.billing_period,features:Array.isArray(a.features)?a.features.join(", "):"",limits:{max_users:a.limits?.max_users?.toString()||"",max_bookings:a.limits?.max_bookings?.toString()||"",max_staff:a.limits?.max_staff?.toString()||"",max_locations:a.limits?.max_locations?.toString()||""},status:a.status})}catch(a){x(a.message||"Error fetching plan"),c({title:"Error",description:a.message||"Error fetching plan",variant:"destructive"})}finally{N(!1)}})()},[n,c]);const t=m=>{const{name:a,value:g}=m.target;if(a.startsWith("limits.")){const C=a.split(".")[1];o({...s,limits:{...s.limits,[C]:g}})}else o({...s,[a]:g})},k=async m=>{if(m.preventDefault(),!!n){f(!0),x("");try{await B(n,{...s,price:parseFloat(s.price),yearly_price:parseFloat(s.yearly_price),features:s.features.split(",").map(a=>a.trim()).filter(a=>a),limits:{max_users:s.limits.max_users?parseInt(s.limits.max_users):void 0,max_bookings:s.limits.max_bookings?parseInt(s.limits.max_bookings):void 0,max_staff:s.limits.max_staff?parseInt(s.limits.max_staff):void 0,max_locations:s.limits.max_locations?parseInt(s.limits.max_locations):void 0}}),c({title:"Success",description:"Plan updated successfully"}),y("/dashboard/plans")}catch(a){x(a.message||"Error updating plan"),c({title:"Error",description:a.message||"Error updating plan",variant:"destructive"})}finally{f(!1)}}};return _?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600"})}):d&&!v?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{to:"/dashboard/plans",children:e.jsx(p,{variant:"ghost",size:"icon",children:e.jsx(j,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Plan"}),e.jsx("p",{className:"text-gray-600",children:"Update subscription plan details"})]})]}),e.jsx("div",{className:"py-8 text-center text-red-600",children:d})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(h,{to:"/dashboard/plans",children:e.jsx(p,{variant:"ghost",size:"icon",children:e.jsx(j,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Edit Plan"}),e.jsx("p",{className:"text-gray-600",children:"Update subscription plan details"})]})]}),e.jsx("form",{onSubmit:k,className:"space-y-6",children:e.jsxs(E,{className:"border-0 shadow-sm",children:[e.jsxs(I,{children:[e.jsx(L,{children:"Plan Details"}),e.jsx(U,{children:"Update the details for this plan"})]}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",children:"Name *"}),e.jsx(r,{id:"name",name:"name",value:s.name,onChange:t,required:!0,placeholder:"Plan name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"billing_period",children:"Billing Period *"}),e.jsxs("select",{id:"billing_period",name:"billing_period",value:s.billing_period,onChange:t,className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"price",children:"Monthly Price *"}),e.jsx(r,{id:"price",name:"price",type:"number",step:"0.01",value:s.price,onChange:t,required:!0,placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"yearly_price",children:"Yearly Price *"}),e.jsx(r,{id:"yearly_price",name:"yearly_price",type:"number",step:"0.01",value:s.yearly_price,onChange:t,required:!0,placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(i,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:s.description,onChange:t,className:"w-full border rounded px-3 py-2 min-h-[80px]",placeholder:"Describe the plan"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(i,{htmlFor:"features",children:"Features (comma separated)"}),e.jsx(r,{id:"features",name:"features",value:s.features,onChange:t,placeholder:"e.g. Unlimited bookings, Priority support"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(i,{children:"Limits"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"limits.max_users",children:"Max Users"}),e.jsx(r,{id:"limits.max_users",name:"limits.max_users",type:"number",min:"0",value:s.limits.max_users,onChange:t,placeholder:"e.g. 10"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"limits.max_bookings",children:"Max Bookings"}),e.jsx(r,{id:"limits.max_bookings",name:"limits.max_bookings",type:"number",min:"0",value:s.limits.max_bookings,onChange:t,placeholder:"e.g. 100"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"limits.max_staff",children:"Max Staff"}),e.jsx(r,{id:"limits.max_staff",name:"limits.max_staff",type:"number",min:"0",value:s.limits.max_staff,onChange:t,placeholder:"e.g. 5"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"limits.max_locations",children:"Max Locations"}),e.jsx(r,{id:"limits.max_locations",name:"limits.max_locations",type:"number",min:"0",value:s.limits.max_locations,onChange:t,placeholder:"e.g. 3"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"status",children:"Active"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("button",{type:"button","aria-pressed":s.status==="active",onClick:()=>o({...s,status:s.status==="active"?"inactive":"active"}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-purple-500 ${s.status==="active"?"bg-gradient-to-r from-purple-600 to-pink-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow transition-transform duration-200 ${s.status==="active"?"translate-x-5":"translate-x-1"}`})}),e.jsx("span",{className:s.status==="active"?"text-green-600 font-semibold":"text-gray-400 font-semibold",children:s.status==="active"?"Active":"Inactive"})]})]})]}),d&&e.jsx("div",{className:"text-red-600 text-sm mt-2",children:d}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(h,{to:"/dashboard/plans",children:e.jsx(p,{variant:"outline",type:"button",children:"Cancel"})}),e.jsx(p,{type:"submit",className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",disabled:u,children:u?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"})," Updating..."]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"})," Update Plan"]})})]})]})]})})]})};export{R as default};
